---
title: "Entrega2_Proyecto1"
author: "Gustavo Cruz; Pedro Guzman"
date: "2025-02-12"
output: html_document
knit: (function(input, ...) { rmarkdown::render(input, output_file = "docs/index.html") })
---

```{r}
movies <- read.csv('movies.csv', stringsAsFactors = FALSE)
```

```{r}
# Cargar librerías necesarias
library(tidyverse)
library(cluster)
library(factoextra)

# Primero, veamos la estructura de los datos
str(movies)

# Verificar cuáles columnas son numéricas
numeric_columns <- movies %>%
  select_if(is.numeric) %>%
  names()

print("Columnas numéricas disponibles:")
print(numeric_columns)

# Crear dataframe solo con variables numéricas relevantes para clustering
movies_numeric <- movies %>%
  select(popularity, budget, revenue, runtime, 
         genresAmount, productionCoAmount, 
         productionCountriesAmount, voteCount, 
         voteAvg, actorsAmount, 
         castWomenAmount, castMenAmount) %>%
  # Convertir explícitamente a numérico si es necesario
  mutate(across(everything(), as.numeric)) %>%
  # Eliminar filas con NA
  na.omit()

# Verificar que no hay problemas con los datos
summary(movies_numeric)

# Ahora sí, escalar los datos
movies_scaled <- scale(movies_numeric)

# Calcular la suma de cuadrados dentro de los clusters para diferentes valores de k
wss <- numeric(20)
for (k in 1:20) {
  km <- kmeans(movies_scaled, centers = k, nstart = 25)
  wss[k] <- km$tot.withinss
}

# Crear gráfica del método del codo
fviz_nbclust(movies_scaled, 
             kmeans, 
             method = "wss",
             k.max = 20) +
  labs(title = "Método del Codo para Determinar k Óptimo",
       x = "Número de Clusters (k)",
       y = "Suma total de cuadrados dentro de clusters") +
  theme_minimal()
```

